function e(){return fetch("http://localhost:3000/movies").then(e=>e.json())}class t{constructor(e,t,o,n){this.title=e,this.genre=t,this.director=o,this.year=n}}class o{constructor(e){this.modal=e}toggle(){this.modal.classList.toggle("is-hidden"),document.body.classList.toggle("no-scroll")}}const n=new o(document.querySelector(".add-modal"));document.querySelector("#add-movie").addEventListener("click",()=>n.toggle()),document.addEventListener("keydown",e=>{n.modal.classList.contains("is-hidden")||"Escape"!==e.code||n.toggle()});const i=new class{constructor(){this.list=document.querySelector(".movies")}createMarkup(e){let t=document.createElement("li");t.classList.add("movies__item"),t.id=e.id;let o=document.createElement("h2");o.classList.add("movies__title"),o.textContent=e.title;let n=document.createElement("p");n.classList.add("movies__genre"),n.textContent=e.genre;let i=document.createElement("p");i.classList.add("movies__director"),i.textContent=e.director;let d=document.createElement("p");d.classList.add("movies__year"),d.textContent=e.year;let s=document.createElement("button");s.textContent="Edit",s.classList.add("edit-movie"),s.id=e.id;let c=document.createElement("button");c.textContent="Delete",c.classList.add("delete-movie"),c.id=e.id,this.list.append(t),t.append(o,n,i,d,s,c)}renderMovies(){e().then(e=>{e.forEach(e=>{this.createMarkup(e)})})}renderAddedMovie(e,o,i,d){fetch("http://localhost:3000/movies",{method:"POST",body:JSON.stringify(new t(e,o,i,d)),headers:{"Content-Type":"application/json; charset=UTF-8"}}).then(e=>e.json()).then(e=>{n.toggle(),this.createMarkup(e)})}};function d(e,o,n,i,d){return fetch(`http://localhost:3000/movies/${e}`,{method:"PATCH",body:JSON.stringify(new t(o,n,i,d)),headers:{"Content-Type":"application/json; charset=UTF-8"}}).then(e=>e.json())}i.renderMovies(),document.querySelector(".add-form").addEventListener("submit",e=>{e.preventDefault();let t=e.target.children;i.renderAddedMovie(t.title.value,t.genre.value,t.director.value,t.year.value)});const s=new o(document.querySelector(".edit-modal"));document.addEventListener("click",function(t){if(t.target.classList.contains("edit-movie")){s.toggle();let o=t.target.closest(".movies__item").id;document.querySelector(".edit-form").addEventListener("submit",t=>{t.preventDefault();let n=t.target.children,i=n.title.value,s=n.genre.value,c=n.director.value,r=n.year.value;i&&s&&c&&r?d(o,i,s,c,r).then(e=>{location.reload()}):e().then(e=>{let t;e.forEach(e=>{if(e.id===o){t=e;let n={title:i||t.title,genre:s||t.genre,director:c||t.director,year:r||t.year};d(o,n.title,n.genre,n.director,n.year).then(()=>{location.reload()})}})})})}}),document.addEventListener("keydown",e=>{s.modal.classList.contains("is-hidden")||"Escape"!==e.code||s.toggle()}),document.addEventListener("click",function(e){if(e.target.classList.contains("delete-movie")){var t;(t=e.target.closest(".movies__item").id,fetch(`http://localhost:3000/movies/${t}`,{method:"DELETE"}).then(e=>e.json())).then(e=>location.reload())}});
//# sourceMappingURL=index.2c7e7fc4.js.map
